pengenalan validation
- saat membuat apliaksi, validasi adalah salah satu hal yang selalu dibuat
- validasi dilakukan untuk memastikan bahwa data yang diproses sudah benar
- validasi adalah sesuatu yang wajib dilakukan saat pembuatan aplikasi, agar kesalahan pada data bisa ditemukan secepat mungkin sebelum data tersebut di proses

tempat melakukan validasi
- validasi sering dilakukan di banyak bagian dalam aplikasi, seperti
- web, seperti validasi request dari pengguna
- bussiness logic, validasi data
- database, validasi constraint
- beberapa bagian, kadang menggunakan validasi yang sama. oleh karena itu pembuatan validasi secara manual sangat memakan waktu, dan kesalahan sedikit bisa menyebabkan validasi tidak konsisten

kenapa butuh validasi?
- untuk memastikan request atau data yang dikirim oleh penguna sudah sesuai dengan yang kita inginkan
- jangan percaya input dari user / never trust user input

manual validation
- saat kita melakukan validasi, biasanya kita akan melakukan validasi secara manual
- rata rata, validasi manual akan menggunakan if statement
- semakin banyak validasi yang diperlukan, semakin banyak if statement yang harus dibuat (manual)

validation library
- penggunaan library untuk melakukan validasi sangat direkomendasikan
- hal ini agar kode validasi lebih mudah, rapi dan juga sama antar programmer
- ada banyak sekali library yang bisa kita gunakan untuk mempermudah dalam pembuatan validasi di kode program kita 
- salah satunya adalah library validator package

validator package
- salah satu library yang banyak digunakan untuk membantu melakukan validation adalah validator package
- validator package adalah opensource library untuk melakukan validation di golang
- validator package memiliki banyak sekali fitur yang bisa kita gunakan untuk mempermudah kita melakukan validasi
- referensi library : https://github.com/go-playground/validator
- install validator package : go get github.com/go-playground/validator
- install validator package (versi 10) : go get github.com/go-playground/validator/v10

validation struct
- validator package di desain agar thread safe (di dalam go routine) dan digunakan sebagai object singleton (cukup buat satu object saja)
- validator package akan melakukan cache informasi seperti rules, tags, dan lain lain yang berhubungan dengan validation kita
- cache adalah menyimpan informasi di memory, sehingga bisa digunakan lagi tanpa harus melakukan eksekusi kode program lagi, hal ini akan mempercepat proses
- jika kita selalu membuat object baru, maka keuntungan cache tidak bisa didapatkan
- package validator merepresentasikan object untuk validationnya dalam struct bernama validate di pakage validator

validasi variable
- sekarang akan mencoba untuk menerapkan validasi terhadap variabel menggunakan validator package
- saat melakukan validasi, biasanya kita akan melakukan validasi terhadap variabel yang tersedia, baik itu variabel yang terdapat di struct atau function parameter
- untuk melakukan validasi variabel, kita bisa gunakan method :
Validate.Var(variabele, tag)
Validate.VarCtx(ctx, variabele, tag)

validator tag
- validator package menggunakan konsep tag untuk menyebutkan validation yang ingin digunakan
- setiap jenis validation, memiliki nama tag masing-masing
- contoh validasi bahwa sebuah value harus ada isinya, bukan default value, misal kita bisa gunakan tag "required", jika number pastikan bukan default number nya adalah 0, dan jika string bukan default value string " " (kosong), dan jika array/slice bukan default array/slice nya [] (kosong)

validasi dua variabel
- kadang, ada kasus dimana kita ingin melakukan validasi untuk membandingkan dua buah variabel
- misal kita mau memastikan variable password dan confirmPassword harus sama, kita bisa gunakan tag 'eqfield'
- untuk melakukan validasi 2 variabel, kita bisa gunakan method :
Validate.VarWithValue(first, second, tag)
Validate.VarWithValueCtx(ctx, first, second, tag)

baked-in validations
- validator package sudah menyediakan banyak sekali validation yang biasanya kita butuhkan, dari yang sederhana seperti required (string tidak boleh kosong), email (format data harus email yang valid), dan lain lain
- ada banyak sekali baked-in validation yang sudah tersedia, dan kita hanya perlu menggunakan nama tag nya saja
- referensi : https://pkg.go.dev/github.com/go-playground/validator/v10#readme-baked-in-validations

multiple tag validation
- tag pada validation bisa lebih dari satu, kita bisa tambahkan koma (,) dan diikuti dengan tag selanjutnya

tag parameter 
- validator package, mendukung penggunaan parameter ketika menggunakan tag
- ini sangat berguna pada kasus validasi yang memang butuh data parameter, contohnya min, max, length dan lain lain
- untuk menggunakan parameter, kita bisa langsung menggunakan tanda sama dengan (=) setelah nama tag, dan diikuti dengan nilai parameternya

validasi struct
- selain melakukan validasi variabel, validator package juga bisa digunakan untuk melakukan validasi terhadap struct
- dengan begitu kita bisa langsung melakukan validasi terhadap semua field yang terdapat pada struct tersebut
- tag untuk validasi, bisa kita tambahkan dengan menambah relfection tag di struct field-nya dengan tag validate

error
- saat kita melakukan validasi, validator package akan mengembalikan data error
- jika eror tersebut bernilai nil, artinya semua data valid, tidak terjadi validation error
- namun jika tidak nil, artinya terdapat data yang error

validation errors
- kita tahu bahwa error adalah kontrak interface dari golang untuk membuat error
- validator package sendiri sebenarnya meiliki detail struct untuk implementasi error ini, yaitu ValidationErrors
- kita bisa melakukan konversi ke ValidationErrors ketika terjadi validation error
- terdapat banyak sekali informasi yang bisa kita ambil dari ValidationErrors
- ValidationErrors sendiri sebenarnya adalah alias untuk []FieldError (interface)

validasi cross field
- sebelumnya kita sudah mengetahui validator package memiliki validation khusus untuk validasi dua variabel
- validation tersebut juga bisa digunakan untuk validasi cross field jika di dalam struct
- caranya kita bisa menggunakan validation tag yang sama, namun perlu disebutkan field kedua-nya
- misal pada password, kita bisa tambahkan 'validate:eqfield=ConfirmPassword'

validasi nested struct
- secara default saat kita membuat struct yang berisikan field struct lainnya
- validator package akan melakukan validasi terhadap field struct tersebut secara otomatis

validasi collection
- tidap seperti tipe data struct, jika kita memiliki field dengan tipe data collection seperti Array, slice atau map, secara default validator package tidak akan melakukan validasi terhadap data-data yang terdapat di dalam collection tersebut
- namun, jika kita ingin melakukan validasi semua data yang terdapat di collection-nya, kita bisa tambahkan tag 'dive'\

basic collection
- bagaimana jika data collection nya adalah tipe data yang bukan struct, misal string[]?
- kita bisa tambahkan validation nya langsung setelah menambahkan tag dive 
- contoh pada field Hobbies []String, kita bisa tambahkan tag dive, required, min=1. Artinya tiap string di []string harus required dan minimalnya adalah 1 karakter

validasi map 
- selain collection array/slice, kita juga bisa melakukan validasi terhadap field Map
- karena dalam map terdapat key dan value, kita bisa menggunakan tag 'dive' untuk key dan tag 'dive' lagi untuk value
- namun khusus untuk key, kita harus tandai dengan tag 'keys' dan diakhiri dengan 'endkeys'

validasi basic map
- jika ingin menambah validasi, pada attribute yang bertipe data map dengan tipe data biasa, caranya sama perlu menambahkan tag keys dan endkeys
- contoh field : Wallet map[string]int dengan tag dive, keys, required, endkeys, required, gt=0 : artinya key string required, dav value required dan lebih dari 0 (karena tipe data value nya int)
- karena value bukanlah struct, jadi kita tidak perlu menambahkan tag dive lagi pada value

alias tag
- pada beberaa kasus, kita sering menggunakan beberapa tag validation yang sama untuk field yang berbeda
- validator package memiliki fitur untuk menambahkan alias, yaitu nama tag baru untuk tag lain, bisa satu atau lebih tag lain
- kita bisa meregistrasi nama alias untuk tag baru dengan menggunakan method :
Validate.RegisterAlias(alias, tag)

custom validation
- bagaimana jika validasi yang kita butuhkan tidak tersedia di baked in validator package?
- kita bisa membuat custom validation sendiri, dengan membuat function yang menerapkan parameter validator.FieldLevel, lalu registrasikan ke validate menggunakan method :
Validate.RegisterValidation(tag, function)

field level 
- merupakan parameter dari validation function nanti yang kita buat (custom validation)
- field level berisikan informasi relfection seperti field value, name dan lain lain

custom validation parameter
- di baked in validation, beberapa validation memiliki parameter, misalnya min=10
- kita juga bisa mengambil informasi nilai parameter nya di FieldLevel.Param()
- ini sangat cocok ketika kita membuat validation yang memang membutuhkan parameter tambahkan

or rule
- pada beberapa kasus, kadang kita ingin membuat kondisi OR pada validation
- misal sebuah field boleh email, atau nomor telepon misalnya, artinya validasinya tidak bisa menggunakan tag email maupun numeric (karena bertentangan)
- sehingga kita bisa menggunakan operator logika dengan menambahkan '|' (pipe) sebagai pemisah untuk menandakan bawha itu adalah OR
- defaultnya beberap tag validasi yang diberikan pada field, jika diberikan koma ',' (koma), maka artinya adalah AND

custom validation cross field
- saat membuat custom validation, parameter FieldLevel juga bisa digunakan untuk mendapatkan value kedua secara langsung dari struct
- kita bisa menggunakan method FieldLevel.GetStructFieldOK2()
- method GetStructFieldOK2() secara otomatis akan menggunakan param sebagai nama field di structnya
- misal ketika kita gunakan tag xxx=Yyy, maka GetStructFieldOK2() akan mengembalikan field Yyy di dalam structnya

struct level validation
- kadang ada kasus untuk melakukan validasi butuh kombinasi lebih dari dua field
- sampai saat ini, kita hanya membuat validasi untuk single field, atau cross field
- validator package mendukung pembuatan validasi di level struct, namun kita perlu membuat validaton function menggunakan parameter struct level
- kita bisa meregistrasi kan validation nya menggunakan method Validate.RegisterStructValidation()